/* the viewport is at least 768 pixels wide */
$(function () {


  function a() {
    var a, f;
    a = document.createElement("div"),

      WebGlMain.appendChild(a),
      h = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 1, 1e4),
      h.position.z = 100, i = new THREE.Scene,
      j = new THREE.CanvasRenderer( { alpha: true } ),
      j.setPixelRatio(window.devicePixelRatio),
      j.setSize(window.innerWidth - 25, window.innerHeight), a.appendChild(j.domElement);


    for (var g = 2 * Math.PI, k = new THREE.SpriteCanvasMaterial({
        color: 16777215, program: function (a) {
          a.beginPath(), a.arc(0, 0, .5, 0, g, !0), a.fill()
        }
      }),

           l = new THREE.Geometry, m = 0; m < 100; m++)
      f = new THREE.Sprite(k),
        f.position.x = 2 * Math.random() - 1,
        f.position.y = 2 * Math.random() - 1,
        f.position.z = 2 * Math.random() - 1,
        f.position.normalize(),
        f.position.multiplyScalar(10 * Math.random() + 450),
        f.scale.x = f.scale.y = 10,
        i.add(f),
        l.vertices.push(f.position);

    var n = new THREE.Line(l, new THREE.LineBasicMaterial({color: 16777215, opacity: .15}));
    i.add(n), document.addEventListener("mousemove", c, !1), document.addEventListener("touchstart", d,
      !1), document.addEventListener("touchmove", e, !1), window.addEventListener("resize", b, !1)
  }

  function b() {
    m = window.innerWidth / 2, n = window.innerHeight / 2, h.aspect = window.innerWidth / window.innerHeight, h.updateProjectionMatrix(), j.setSize(
      window.innerWidth, window.innerHeight)
  }

  function c(a) {
    k = a.clientX - m, l = a.clientY - n
  }

  function d(a) {
    a.touches.length > 1 && (a.preventDefault(), k = a.touches[0].pageX - m, l = a.touches[0].pageY - n)
  }

  function e(a) {
    1 == a.touches.length && (a.preventDefault(), k = a.touches[0].pageX - m, l = a.touches[0].pageY - n)
  }

  function f() {
    requestAnimationFrame(f), g()
  }

  function g() {
    h.position.x += .05 * (k - h.position.x), h.position.y += .05 * (-l + 200 - h.position.y), h.lookAt(
      i.position), j.render(i, h)
  }

  var h, i, j, k = 0, l = 0, m = window.innerWidth / 2, n = window.innerHeight / 2;
  a(), f()


})
